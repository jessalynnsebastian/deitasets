<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>`children` Data Demo: Overdispersion in Poisson Regression and Linear Contrasts • deitasets</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="`children` Data Demo: Overdispersion in Poisson Regression and Linear Contrasts">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">deitasets</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/children.html">`children` Data Demo: Overdispersion in Poisson Regression and Linear Contrasts</a></li>
    <li><a class="dropdown-item" href="../articles/students.html">`students` Data Demo: Confounding and Factors Associated with Postsecondary Education</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>`children` Data Demo: Overdispersion in Poisson Regression and Linear Contrasts</h1>
            
      

      <div class="d-none name"><code>children.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://jessalynnsebastian.github.io/deitasets/">deitasets</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ddsjoberg/gtsummary" class="external-link">gtsummary</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://hbiostat.org/R/Hmisc/" class="external-link">Hmisc</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Prepare data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">children</span><span class="op">)</span></span>
<span><span class="va">children</span><span class="op">$</span><span class="va">household_income</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">children</span><span class="op">$</span><span class="va">household_income</span>,</span>
<span>  levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"$0 to $10,000"</span>, <span class="st">"$10,001 to $20,000"</span>, <span class="st">"$20,001 to $30,000"</span>,</span>
<span>    <span class="st">"$30,001 to $40,000"</span>, <span class="st">"$40,001 to $50,000"</span>, <span class="st">"$50,001 to $60,000"</span>,</span>
<span>    <span class="st">"$60,001 to $75,000"</span>, <span class="st">"$75,001 to $100,000"</span>, <span class="st">"$100,001 to $150,000"</span>,</span>
<span>    <span class="st">"$150,001 to $200,000"</span>, <span class="st">"$200,001 to $250,000"</span>, <span class="st">"$250,001 or more"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/Hmisc/man/label.html" class="external-link">label</a></span><span class="op">(</span><span class="va">children</span><span class="op">$</span><span class="va">household_income</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"Household Income"</span></span></code></pre></div>
<div class="section level2">
<h2 id="poisson-regression">Poisson Regression<a class="anchor" aria-label="anchor" href="#poisson-regression"></a>
</h2>
<p>Suppose we want to model the number of books a child owns as a
function of their household’s income. Because the response is a count,
linear regression is not ideal: counts are non-negative, often skewed,
and their variance typically changes with the mean. Poisson regression
addresses this and provides inference on multiplicative (relative)
effects.</p>
<p>We model the number of children’s books
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mi>i</mi></msub><annotation encoding="application/x-tex">Y_i</annotation></semantics></math>)
as a function of household income
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mi>i</mi></msub><annotation encoding="application/x-tex">x_i</annotation></semantics></math>).</p>
<p><strong>Model:</strong>
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mi>i</mi></msub><mo>∣</mo><msub><mi>x</mi><mi>i</mi></msub><mo>∼</mo><mtext mathvariant="normal">Poisson</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>μ</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mspace width="1.0em"></mspace><mo>log</mo><msub><mi>μ</mi><mi>i</mi></msub><mo>=</mo><msub><mi>η</mi><mi>i</mi></msub><mo>=</mo><msubsup><mi>x</mi><mi>i</mi><mi>⊤</mi></msubsup><mi>β</mi><mi>.</mi></mrow><annotation encoding="application/x-tex">
Y_i \mid x_i \sim \text{Poisson}(\mu_i), \quad \log \mu_i = \eta_i = x_i^\top \beta.
</annotation></semantics></math></p>
<p>Here,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>μ</mi><mi>i</mi></msub><mo>=</mo><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>Y</mi><mi>i</mi></msub><mo>∣</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\mu_i = E[Y_i \mid x_i]</annotation></semantics></math>
and the canonical log link ensures
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>μ</mi><mi>i</mi></msub><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\mu_i &gt; 0</annotation></semantics></math>.</p>
<p>The Poisson GLM implies the mean-variance relationship:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Var</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mi>i</mi></msub><mo>∣</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>μ</mi><mi>i</mi></msub><mi>.</mi></mrow><annotation encoding="application/x-tex">
\text{Var}(Y_i \mid x_i) = \mu_i.
</annotation></semantics></math></p>
<p>Under this model, coefficients
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>
are estimated by maximizing the Poisson log-likelihood; exponentiated
coefficients correspond to rate ratios relative to a reference income
level.</p>
<p>We fit a Poisson generalized linear model (GLM) with a log link:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mdl_pois</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">child_num_books</span> <span class="op">~</span> <span class="va">household_income</span>,</span>
<span>  data <span class="op">=</span> <span class="va">children</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">poisson</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"log"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://www.danieldsjoberg.com/gtsummary/reference/tbl_regression.html" class="external-link">tbl_regression</a></span><span class="op">(</span><span class="va">mdl_pois</span>, exponentiate <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div id="mwlefoodfi" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#mwlefoodfi table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#mwlefoodfi thead, #mwlefoodfi tbody, #mwlefoodfi tfoot, #mwlefoodfi tr, #mwlefoodfi td, #mwlefoodfi th {
  border-style: none;
}

#mwlefoodfi p {
  margin: 0;
  padding: 0;
}

#mwlefoodfi .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#mwlefoodfi .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#mwlefoodfi .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#mwlefoodfi .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#mwlefoodfi .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mwlefoodfi .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mwlefoodfi .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mwlefoodfi .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#mwlefoodfi .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#mwlefoodfi .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#mwlefoodfi .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#mwlefoodfi .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#mwlefoodfi .gt_spanner_row {
  border-bottom-style: hidden;
}

#mwlefoodfi .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#mwlefoodfi .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#mwlefoodfi .gt_from_md > :first-child {
  margin-top: 0;
}

#mwlefoodfi .gt_from_md > :last-child {
  margin-bottom: 0;
}

#mwlefoodfi .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#mwlefoodfi .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#mwlefoodfi .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#mwlefoodfi .gt_row_group_first td {
  border-top-width: 2px;
}

#mwlefoodfi .gt_row_group_first th {
  border-top-width: 2px;
}

#mwlefoodfi .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mwlefoodfi .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#mwlefoodfi .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#mwlefoodfi .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mwlefoodfi .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mwlefoodfi .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#mwlefoodfi .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#mwlefoodfi .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#mwlefoodfi .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mwlefoodfi .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mwlefoodfi .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mwlefoodfi .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mwlefoodfi .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mwlefoodfi .gt_left {
  text-align: left;
}

#mwlefoodfi .gt_center {
  text-align: center;
}

#mwlefoodfi .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#mwlefoodfi .gt_font_normal {
  font-weight: normal;
}

#mwlefoodfi .gt_font_bold {
  font-weight: bold;
}

#mwlefoodfi .gt_font_italic {
  font-style: italic;
}

#mwlefoodfi .gt_super {
  font-size: 65%;
}

#mwlefoodfi .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#mwlefoodfi .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#mwlefoodfi .gt_indent_1 {
  text-indent: 5px;
}

#mwlefoodfi .gt_indent_2 {
  text-indent: 10px;
}

#mwlefoodfi .gt_indent_3 {
  text-indent: 15px;
}

#mwlefoodfi .gt_indent_4 {
  text-indent: 20px;
}

#mwlefoodfi .gt_indent_5 {
  text-indent: 25px;
}

#mwlefoodfi .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#mwlefoodfi div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="table gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead><tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="label"><span class="gt_from_md"><strong>Characteristic</strong></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="estimate"><span class="gt_from_md"><strong>IRR</strong></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="conf.low"><span class="gt_from_md"><strong>95% CI</strong></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="p.value"><span class="gt_from_md"><strong>p-value</strong></span></th>
    </tr></thead>
<tbody class="gt_table_body">
<tr>
<td headers="label" class="gt_row gt_left">Household Income</td>
<td headers="estimate" class="gt_row gt_center"><br></td>
<td headers="conf.low" class="gt_row gt_center"><br></td>
<td headers="p.value" class="gt_row gt_center"><br></td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">    $0 to $10,000</td>
<td headers="estimate" class="gt_row gt_center">—</td>
<td headers="conf.low" class="gt_row gt_center">—</td>
<td headers="p.value" class="gt_row gt_center"><br></td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">    $10,001 to $20,000</td>
<td headers="estimate" class="gt_row gt_center">1.19</td>
<td headers="conf.low" class="gt_row gt_center">1.16, 1.22</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">    $20,001 to $30,000</td>
<td headers="estimate" class="gt_row gt_center">1.04</td>
<td headers="conf.low" class="gt_row gt_center">1.02, 1.07</td>
<td headers="p.value" class="gt_row gt_center">0.001</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">    $30,001 to $40,000</td>
<td headers="estimate" class="gt_row gt_center">1.26</td>
<td headers="conf.low" class="gt_row gt_center">1.23, 1.29</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">    $40,001 to $50,000</td>
<td headers="estimate" class="gt_row gt_center">1.64</td>
<td headers="conf.low" class="gt_row gt_center">1.60, 1.67</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">    $50,001 to $60,000</td>
<td headers="estimate" class="gt_row gt_center">1.78</td>
<td headers="conf.low" class="gt_row gt_center">1.74, 1.82</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">    $60,001 to $75,000</td>
<td headers="estimate" class="gt_row gt_center">1.93</td>
<td headers="conf.low" class="gt_row gt_center">1.89, 1.97</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">    $75,001 to $100,000</td>
<td headers="estimate" class="gt_row gt_center">2.26</td>
<td headers="conf.low" class="gt_row gt_center">2.22, 2.31</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">    $100,001 to $150,000</td>
<td headers="estimate" class="gt_row gt_center">2.40</td>
<td headers="conf.low" class="gt_row gt_center">2.35, 2.45</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">    $150,001 to $200,000</td>
<td headers="estimate" class="gt_row gt_center">2.49</td>
<td headers="conf.low" class="gt_row gt_center">2.44, 2.54</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">    $200,001 to $250,000</td>
<td headers="estimate" class="gt_row gt_center">2.59</td>
<td headers="conf.low" class="gt_row gt_center">2.53, 2.64</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">    $250,001 or more</td>
<td headers="estimate" class="gt_row gt_center">2.97</td>
<td headers="conf.low" class="gt_row gt_center">2.91, 3.03</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td>
</tr>
</tbody>
<tfoot class="gt_sourcenotes"><tr>
<td class="gt_sourcenote" colspan="4"><span class="gt_from_md">Abbreviations: CI = Confidence Interval, IRR = Incidence Rate Ratio</span></td>
    </tr></tfoot>
</table>
</div>
<p>The confidence intervals here are extremely narrow. Should we expect
that? Poisson regression assumes the variance equals the mean within
each group (the equidispersion assumption). If the data are
overdispersed (variance &gt; mean), standard errors will be
underestimated and CIs too tight.</p>
<p>If the equidispersion assumption holds, the model-based standard
errors and CIs are appropriate. However, if the data are overdispersed,
Poisson standard errors are too small and CIs too narrow.</p>
<div class="section level3">
<h3 id="a-quick-variance-diagnostic-pearson-residuals">A Quick Variance Diagnostic: Pearson Residuals<a class="anchor" aria-label="anchor" href="#a-quick-variance-diagnostic-pearson-residuals"></a>
</h3>
<p>The Pearson residual for observation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
is:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>r</mi><mi>i</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>P</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>=</mo><mfrac><mrow><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><msub><mover><mi>μ</mi><mo accent="true">̂</mo></mover><mi>i</mi></msub></mrow><msqrt><mrow><mi>V</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mover><mi>μ</mi><mo accent="true">̂</mo></mover><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msqrt></mfrac><mo>,</mo></mrow><annotation encoding="application/x-tex">
r_i^{(P)} = \frac{y_i - \hat{\mu}_i}{\sqrt{V(\hat{\mu}_i)}},
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>μ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">V(\mu)</annotation></semantics></math>
is the variance function. For the Poisson GLM,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>μ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>μ</mi></mrow><annotation encoding="application/x-tex">V(\mu) = \mu</annotation></semantics></math>,
so:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>r</mi><mi>i</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>P</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>=</mo><mfrac><mrow><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><msub><mover><mi>μ</mi><mo accent="true">̂</mo></mover><mi>i</mi></msub></mrow><msqrt><msub><mover><mi>μ</mi><mo accent="true">̂</mo></mover><mi>i</mi></msub></msqrt></mfrac><mi>.</mi></mrow><annotation encoding="application/x-tex">
r_i^{(P)} = \frac{y_i - \hat{\mu}_i}{\sqrt{\hat{\mu}_i}}.
</annotation></semantics></math></p>
<p><strong>Key property:</strong> If the mean is correctly specified and
the variance follows the Poisson mean-variance relationship, then:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>r</mi><mi>i</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>P</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo stretchy="true" form="postfix">]</mo></mrow><mo>≈</mo><mn>1</mn><mi>.</mi></mrow><annotation encoding="application/x-tex">
E\left[(r_i^{(P)})^2\right] \approx 1.
</annotation></semantics></math></p>
<p>Thus, plotting squared Pearson residuals against fitted values should
hover around a horizontal line at 1. Systematic deviations indicate
variance misspecification (such as overdispersion).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fitted_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mdl_pois</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span>
<span><span class="va">sq_pearson_residuals</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals</a></span><span class="op">(</span><span class="va">mdl_pois</span>, type <span class="op">=</span> <span class="st">"pearson"</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span></span>
<span></span>
<span><span class="co"># Plot squared Pearson residuals vs fitted values</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fitted_values</span>, <span class="va">sq_pearson_residuals</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Fitted Values"</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"Squared Pearson Residuals"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Squared Pearson Residuals vs Fitted Values"</span>,</span>
<span>     pch <span class="op">=</span> <span class="fl">16</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span>
<span><span class="co"># Add a smoother to the plot</span></span>
<span><span class="va">smooth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lowess.html" class="external-link">lowess</a></span><span class="op">(</span><span class="va">fitted_values</span>, <span class="va">sq_pearson_residuals</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">smooth</span>, col <span class="op">=</span> <span class="st">"red"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="children_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Zoom in on the plot</span></span>
<span><span class="va">ylim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">smooth</span><span class="op">$</span><span class="va">y</span><span class="op">)</span> <span class="op">*</span> <span class="fl">0.9</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">smooth</span><span class="op">$</span><span class="va">y</span><span class="op">)</span> <span class="op">*</span> <span class="fl">1.1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fitted_values</span>, <span class="va">sq_pearson_residuals</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"Fitted Values"</span>,</span>
<span>  ylab <span class="op">=</span> <span class="st">"Squared Pearson Residuals"</span>,</span>
<span>  main <span class="op">=</span> <span class="st">"Zoomed-In View: Squared Pearson Residuals vs Fitted Values"</span>,</span>
<span>  pch <span class="op">=</span> <span class="fl">16</span>, col <span class="op">=</span> <span class="st">"blue"</span>, ylim <span class="op">=</span> <span class="va">ylim</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lowess.html" class="external-link">lowess</a></span><span class="op">(</span><span class="va">fitted_values</span>, <span class="va">sq_pearson_residuals</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"red"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="children_files/figure-html/unnamed-chunk-4-2.png" width="700"></p>
<p>A lowess (smoothed) curve drifting well above 1 (and/or a large
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>ϕ</mi><mo accent="true">̂</mo></mover><annotation encoding="application/x-tex">\hat{\phi}</annotation></semantics></math>)
is consistent with overdispersion.</p>
</div>
</div>
<div class="section level2">
<h2 id="modeling-overdispersed-counts">Modeling Overdispersed Counts<a class="anchor" aria-label="anchor" href="#modeling-overdispersed-counts"></a>
</h2>
<p>Common approaches include:</p>
<ul>
<li>Quasi-Poisson (variance proportional to the mean, rather than
equal),</li>
<li>Negative binomial (variance quadratic in the mean),</li>
<li>Robust (sandwich) standard errors for the Poisson model.</li>
</ul>
<p>These differ in how they alter the variance and in what they assume
about the data-generating process.</p>
<div class="section level3">
<h3 id="quasi-poisson">Quasi-Poisson<a class="anchor" aria-label="anchor" href="#quasi-poisson"></a>
</h3>
<p>Here, we keep the Poisson mean model and link, but allow a free
dispersion parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi><mo>&gt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\phi &gt; 1</annotation></semantics></math>:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Var</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mi>i</mi></msub><mo>∣</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>ϕ</mi><mspace width="0.167em"></mspace><msub><mi>μ</mi><mi>i</mi></msub><mi>.</mi></mrow><annotation encoding="application/x-tex">
\text{Var}(Y_i \mid x_i) = \phi \, \mu_i.
</annotation></semantics></math> Estimation proceeds via
quasi-likelihood. Point estimates
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>β</mi><mo accent="true">̂</mo></mover><annotation encoding="application/x-tex">\hat{\beta}</annotation></semantics></math>
match the Poisson GLM, but standard errors are inflated by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>ϕ</mi><mo accent="true">̂</mo></mover><annotation encoding="application/x-tex">\hat{\phi}</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>ϕ</mi><mo accent="true">̂</mo></mover><annotation encoding="application/x-tex">\hat{\phi}</annotation></semantics></math>
is often the Pearson chi-square divided by residual degrees of freedom.
This directly widens confidence intervals and adjusts p-values.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mdl_quasi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">child_num_books</span> <span class="op">~</span> <span class="va">household_income</span>,</span>
<span>  data <span class="op">=</span> <span class="va">children</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">quasipoisson</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"log"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://www.danieldsjoberg.com/gtsummary/reference/tbl_regression.html" class="external-link">tbl_regression</a></span><span class="op">(</span><span class="va">mdl_quasi</span>, exponentiate <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div id="iykapwokta" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#iykapwokta table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#iykapwokta thead, #iykapwokta tbody, #iykapwokta tfoot, #iykapwokta tr, #iykapwokta td, #iykapwokta th {
  border-style: none;
}

#iykapwokta p {
  margin: 0;
  padding: 0;
}

#iykapwokta .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#iykapwokta .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#iykapwokta .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#iykapwokta .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#iykapwokta .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#iykapwokta .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#iykapwokta .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#iykapwokta .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#iykapwokta .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#iykapwokta .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#iykapwokta .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#iykapwokta .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#iykapwokta .gt_spanner_row {
  border-bottom-style: hidden;
}

#iykapwokta .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#iykapwokta .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#iykapwokta .gt_from_md > :first-child {
  margin-top: 0;
}

#iykapwokta .gt_from_md > :last-child {
  margin-bottom: 0;
}

#iykapwokta .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#iykapwokta .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#iykapwokta .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#iykapwokta .gt_row_group_first td {
  border-top-width: 2px;
}

#iykapwokta .gt_row_group_first th {
  border-top-width: 2px;
}

#iykapwokta .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#iykapwokta .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#iykapwokta .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#iykapwokta .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#iykapwokta .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#iykapwokta .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#iykapwokta .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#iykapwokta .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#iykapwokta .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#iykapwokta .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#iykapwokta .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#iykapwokta .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#iykapwokta .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#iykapwokta .gt_left {
  text-align: left;
}

#iykapwokta .gt_center {
  text-align: center;
}

#iykapwokta .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#iykapwokta .gt_font_normal {
  font-weight: normal;
}

#iykapwokta .gt_font_bold {
  font-weight: bold;
}

#iykapwokta .gt_font_italic {
  font-style: italic;
}

#iykapwokta .gt_super {
  font-size: 65%;
}

#iykapwokta .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#iykapwokta .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#iykapwokta .gt_indent_1 {
  text-indent: 5px;
}

#iykapwokta .gt_indent_2 {
  text-indent: 10px;
}

#iykapwokta .gt_indent_3 {
  text-indent: 15px;
}

#iykapwokta .gt_indent_4 {
  text-indent: 20px;
}

#iykapwokta .gt_indent_5 {
  text-indent: 25px;
}

#iykapwokta .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#iykapwokta div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="table gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead><tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="label"><span class="gt_from_md"><strong>Characteristic</strong></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="estimate"><span class="gt_from_md"><strong>IRR</strong></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="conf.low"><span class="gt_from_md"><strong>95% CI</strong></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="p.value"><span class="gt_from_md"><strong>p-value</strong></span></th>
    </tr></thead>
<tbody class="gt_table_body">
<tr>
<td headers="label" class="gt_row gt_left">Household Income</td>
<td headers="estimate" class="gt_row gt_center"><br></td>
<td headers="conf.low" class="gt_row gt_center"><br></td>
<td headers="p.value" class="gt_row gt_center"><br></td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">    $0 to $10,000</td>
<td headers="estimate" class="gt_row gt_center">—</td>
<td headers="conf.low" class="gt_row gt_center">—</td>
<td headers="p.value" class="gt_row gt_center"><br></td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">    $10,001 to $20,000</td>
<td headers="estimate" class="gt_row gt_center">1.19</td>
<td headers="conf.low" class="gt_row gt_center">0.92, 1.54</td>
<td headers="p.value" class="gt_row gt_center">0.2</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">    $20,001 to $30,000</td>
<td headers="estimate" class="gt_row gt_center">1.04</td>
<td headers="conf.low" class="gt_row gt_center">0.82, 1.33</td>
<td headers="p.value" class="gt_row gt_center">0.8</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">    $30,001 to $40,000</td>
<td headers="estimate" class="gt_row gt_center">1.26</td>
<td headers="conf.low" class="gt_row gt_center">1.00, 1.60</td>
<td headers="p.value" class="gt_row gt_center">0.056</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">    $40,001 to $50,000</td>
<td headers="estimate" class="gt_row gt_center">1.64</td>
<td headers="conf.low" class="gt_row gt_center">1.31, 2.06</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">    $50,001 to $60,000</td>
<td headers="estimate" class="gt_row gt_center">1.78</td>
<td headers="conf.low" class="gt_row gt_center">1.42, 2.23</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">    $60,001 to $75,000</td>
<td headers="estimate" class="gt_row gt_center">1.93</td>
<td headers="conf.low" class="gt_row gt_center">1.56, 2.40</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">    $75,001 to $100,000</td>
<td headers="estimate" class="gt_row gt_center">2.26</td>
<td headers="conf.low" class="gt_row gt_center">1.85, 2.79</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">    $100,001 to $150,000</td>
<td headers="estimate" class="gt_row gt_center">2.40</td>
<td headers="conf.low" class="gt_row gt_center">1.97, 2.95</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">    $150,001 to $200,000</td>
<td headers="estimate" class="gt_row gt_center">2.49</td>
<td headers="conf.low" class="gt_row gt_center">2.03, 3.09</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">    $200,001 to $250,000</td>
<td headers="estimate" class="gt_row gt_center">2.59</td>
<td headers="conf.low" class="gt_row gt_center">2.06, 3.26</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">    $250,001 or more</td>
<td headers="estimate" class="gt_row gt_center">2.97</td>
<td headers="conf.low" class="gt_row gt_center">2.41, 3.69</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td>
</tr>
</tbody>
<tfoot class="gt_sourcenotes"><tr>
<td class="gt_sourcenote" colspan="4"><span class="gt_from_md">Abbreviations: CI = Confidence Interval, IRR = Incidence Rate Ratio</span></td>
    </tr></tfoot>
</table>
</div>
<p>Note how the confidence intervals widen relative to the Poisson
fit.</p>
</div>
<div class="section level3">
<h3 id="negative-binomial">Negative Binomial<a class="anchor" aria-label="anchor" href="#negative-binomial"></a>
</h3>
<p>Here, we model the data as coming from a Negative Binomial
distribution, which yields a variance that grows quadratically with the
mean:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Var</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mi>i</mi></msub><mo>∣</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>μ</mi><mi>i</mi></msub><mo>+</mo><mi>α</mi><mspace width="0.167em"></mspace><msubsup><mi>μ</mi><mi>i</mi><mn>2</mn></msubsup><mo>,</mo></mrow><annotation encoding="application/x-tex">
\text{Var}(Y_i \mid x_i) = \mu_i + \alpha \, \mu_i^2,
</annotation></semantics></math> with dispersion
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\alpha &gt; 0</annotation></semantics></math>.
The mean model remains:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><msub><mi>μ</mi><mi>i</mi></msub><mo>=</mo><msubsup><mi>x</mi><mi>i</mi><mi>⊤</mi></msubsup><mi>β</mi><mi>.</mi></mrow><annotation encoding="application/x-tex">
\log \mu_i = x_i^\top \beta.
</annotation></semantics></math></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compute robust SEs with sandwich package</span></span>
<span><span class="va">vcov</span> <span class="op">&lt;-</span> <span class="fu">sandwich</span><span class="fu">::</span><span class="fu"><a href="https://sandwich.R-Forge.R-project.org/reference/vcovHC.html" class="external-link">vcovHC</a></span><span class="op">(</span><span class="va">mdl_pois</span>, type <span class="op">=</span> <span class="st">"HC0"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://www.danieldsjoberg.com/gtsummary/reference/tbl_regression.html" class="external-link">tbl_regression</a></span><span class="op">(</span><span class="va">mdl_pois</span>, tidy_fun <span class="op">=</span> <span class="fu">gtsummary</span><span class="fu">::</span><span class="va"><a href="https://www.danieldsjoberg.com/gtsummary/reference/custom_tidiers.html" class="external-link">tidy_robust</a></span>,</span>
<span>               vcov <span class="op">=</span> <span class="va">vcov</span>, exponentiate <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div id="eekpgwxpef" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#eekpgwxpef table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#eekpgwxpef thead, #eekpgwxpef tbody, #eekpgwxpef tfoot, #eekpgwxpef tr, #eekpgwxpef td, #eekpgwxpef th {
  border-style: none;
}

#eekpgwxpef p {
  margin: 0;
  padding: 0;
}

#eekpgwxpef .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#eekpgwxpef .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#eekpgwxpef .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#eekpgwxpef .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#eekpgwxpef .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#eekpgwxpef .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#eekpgwxpef .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#eekpgwxpef .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#eekpgwxpef .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#eekpgwxpef .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#eekpgwxpef .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#eekpgwxpef .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#eekpgwxpef .gt_spanner_row {
  border-bottom-style: hidden;
}

#eekpgwxpef .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#eekpgwxpef .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#eekpgwxpef .gt_from_md > :first-child {
  margin-top: 0;
}

#eekpgwxpef .gt_from_md > :last-child {
  margin-bottom: 0;
}

#eekpgwxpef .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#eekpgwxpef .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#eekpgwxpef .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#eekpgwxpef .gt_row_group_first td {
  border-top-width: 2px;
}

#eekpgwxpef .gt_row_group_first th {
  border-top-width: 2px;
}

#eekpgwxpef .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#eekpgwxpef .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#eekpgwxpef .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#eekpgwxpef .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#eekpgwxpef .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#eekpgwxpef .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#eekpgwxpef .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#eekpgwxpef .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#eekpgwxpef .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#eekpgwxpef .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#eekpgwxpef .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#eekpgwxpef .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#eekpgwxpef .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#eekpgwxpef .gt_left {
  text-align: left;
}

#eekpgwxpef .gt_center {
  text-align: center;
}

#eekpgwxpef .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#eekpgwxpef .gt_font_normal {
  font-weight: normal;
}

#eekpgwxpef .gt_font_bold {
  font-weight: bold;
}

#eekpgwxpef .gt_font_italic {
  font-style: italic;
}

#eekpgwxpef .gt_super {
  font-size: 65%;
}

#eekpgwxpef .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#eekpgwxpef .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#eekpgwxpef .gt_indent_1 {
  text-indent: 5px;
}

#eekpgwxpef .gt_indent_2 {
  text-indent: 10px;
}

#eekpgwxpef .gt_indent_3 {
  text-indent: 15px;
}

#eekpgwxpef .gt_indent_4 {
  text-indent: 20px;
}

#eekpgwxpef .gt_indent_5 {
  text-indent: 25px;
}

#eekpgwxpef .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#eekpgwxpef div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="table gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead><tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="label"><span class="gt_from_md"><strong>Characteristic</strong></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="estimate"><span class="gt_from_md"><strong>IRR</strong></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="conf.low"><span class="gt_from_md"><strong>95% CI</strong></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="p.value"><span class="gt_from_md"><strong>p-value</strong></span></th>
    </tr></thead>
<tbody class="gt_table_body">
<tr>
<td headers="label" class="gt_row gt_left">Household Income</td>
<td headers="estimate" class="gt_row gt_center"><br></td>
<td headers="conf.low" class="gt_row gt_center"><br></td>
<td headers="p.value" class="gt_row gt_center"><br></td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">    $0 to $10,000</td>
<td headers="estimate" class="gt_row gt_center">—</td>
<td headers="conf.low" class="gt_row gt_center">—</td>
<td headers="p.value" class="gt_row gt_center"><br></td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">    $10,001 to $20,000</td>
<td headers="estimate" class="gt_row gt_center">1.19</td>
<td headers="conf.low" class="gt_row gt_center">0.90, 1.57</td>
<td headers="p.value" class="gt_row gt_center">0.2</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">    $20,001 to $30,000</td>
<td headers="estimate" class="gt_row gt_center">1.04</td>
<td headers="conf.low" class="gt_row gt_center">0.81, 1.34</td>
<td headers="p.value" class="gt_row gt_center">0.8</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">    $30,001 to $40,000</td>
<td headers="estimate" class="gt_row gt_center">1.26</td>
<td headers="conf.low" class="gt_row gt_center">0.97, 1.63</td>
<td headers="p.value" class="gt_row gt_center">0.082</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">    $40,001 to $50,000</td>
<td headers="estimate" class="gt_row gt_center">1.64</td>
<td headers="conf.low" class="gt_row gt_center">1.26, 2.12</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">    $50,001 to $60,000</td>
<td headers="estimate" class="gt_row gt_center">1.78</td>
<td headers="conf.low" class="gt_row gt_center">1.37, 2.29</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">    $60,001 to $75,000</td>
<td headers="estimate" class="gt_row gt_center">1.93</td>
<td headers="conf.low" class="gt_row gt_center">1.52, 2.45</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">    $75,001 to $100,000</td>
<td headers="estimate" class="gt_row gt_center">2.26</td>
<td headers="conf.low" class="gt_row gt_center">1.79, 2.86</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">    $100,001 to $150,000</td>
<td headers="estimate" class="gt_row gt_center">2.40</td>
<td headers="conf.low" class="gt_row gt_center">1.91, 3.02</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">    $150,001 to $200,000</td>
<td headers="estimate" class="gt_row gt_center">2.49</td>
<td headers="conf.low" class="gt_row gt_center">1.96, 3.15</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">    $200,001 to $250,000</td>
<td headers="estimate" class="gt_row gt_center">2.59</td>
<td headers="conf.low" class="gt_row gt_center">2.00, 3.34</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">    $250,001 or more</td>
<td headers="estimate" class="gt_row gt_center">2.97</td>
<td headers="conf.low" class="gt_row gt_center">2.33, 3.77</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td>
</tr>
</tbody>
<tfoot class="gt_sourcenotes"><tr>
<td class="gt_sourcenote" colspan="4"><span class="gt_from_md">Abbreviations: CI = Confidence Interval, IRR = Incidence Rate Ratio</span></td>
    </tr></tfoot>
</table>
</div>
</div>
<div class="section level3">
<h3 id="how-do-you-choose">How do you choose?<a class="anchor" aria-label="anchor" href="#how-do-you-choose"></a>
</h3>
<ol style="list-style-type: decimal">
<li><strong>Fix underestimation of uncertainty, same mean
model:</strong></li>
</ol>
<ul>
<li>Use quasi-Poisson or robust SEs. They typically yield similar
results, but are conceptually distinct.</li>
<li>Quasi-Poisson also returns an estimated dispersion parameter
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ϕ</mi><annotation encoding="application/x-tex">\phi</annotation></semantics></math>).</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li><strong>Need a full distribution for counts or variance grows
quadratically with the mean:</strong></li>
</ol>
<ul>
<li>Use negative binomial regression. This is useful for simulation,
AIC-based model selection, or prediction intervals.</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li><strong>Diagnostics:</strong></li>
</ol>
<ul>
<li>Check the estimated dispersion parameter
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>ϕ</mi><mo accent="true">̂</mo></mover><annotation encoding="application/x-tex">\hat{\phi}</annotation></semantics></math>)
using Pearson-based methods.</li>
<li>Plot squared Pearson residuals vs. fitted values and look for a
horizontal trend around 1.</li>
<li>Compare inferential conclusions across methods. If both negative
binomial and quasi-Poisson materially change inference compared to
Poisson, it strongly suggests that the Poisson equidispersion assumption
was too restrictive.</li>
</ul>
<ol start="4" style="list-style-type: decimal">
<li><strong>Additional Notes:</strong></li>
</ol>
<ul>
<li>Overdispersion can result from unmodeled heterogeneity (e.g.,
omitted covariates, clustering), zero-inflation, or temporal/spatial
correlation.</li>
<li>If patterns persist after switching variance models, consider
refining the mean structure or using clustered/GLMM approaches.</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="interpreting-the-coefficients-and-using-linear-contrasts">Interpreting the Coefficients and Using Linear Contrasts<a class="anchor" aria-label="anchor" href="#interpreting-the-coefficients-and-using-linear-contrasts"></a>
</h2>
<p>With a log link, coefficients are on the log scale; exponentiating
yields rate ratios (RRs). For a given income category
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
versus the reference category (here “$0 to $10,000”),
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>β</mi><mi>k</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\exp(\beta_k)</annotation></semantics></math>
is the multiplicative change in expected book counts.</p>
<p>Sometimes we need comparisons between two non-reference groups. You
can either relevel the factor or compute a linear contrast on the
original model.</p>
<p>Here’s how we’d do it the naive way, by changing the baseline and
redoing the regression:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">children</span><span class="op">$</span><span class="va">household_income</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/relevel.html" class="external-link">relevel</a></span><span class="op">(</span><span class="va">children</span><span class="op">$</span><span class="va">household_income</span>, ref <span class="op">=</span> <span class="st">"$50,001 to $60,000"</span><span class="op">)</span></span>
<span><span class="va">mdl_relevel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">child_num_books</span> <span class="op">~</span> <span class="va">household_income</span>,</span>
<span>  data <span class="op">=</span> <span class="va">children</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">quasipoisson</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"log"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://www.danieldsjoberg.com/gtsummary/reference/tbl_regression.html" class="external-link">tbl_regression</a></span><span class="op">(</span><span class="va">mdl_relevel</span>, exponentiate <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div id="scpjyehcmn" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#scpjyehcmn table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#scpjyehcmn thead, #scpjyehcmn tbody, #scpjyehcmn tfoot, #scpjyehcmn tr, #scpjyehcmn td, #scpjyehcmn th {
  border-style: none;
}

#scpjyehcmn p {
  margin: 0;
  padding: 0;
}

#scpjyehcmn .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#scpjyehcmn .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#scpjyehcmn .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#scpjyehcmn .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#scpjyehcmn .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#scpjyehcmn .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#scpjyehcmn .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#scpjyehcmn .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#scpjyehcmn .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#scpjyehcmn .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#scpjyehcmn .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#scpjyehcmn .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#scpjyehcmn .gt_spanner_row {
  border-bottom-style: hidden;
}

#scpjyehcmn .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#scpjyehcmn .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#scpjyehcmn .gt_from_md > :first-child {
  margin-top: 0;
}

#scpjyehcmn .gt_from_md > :last-child {
  margin-bottom: 0;
}

#scpjyehcmn .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#scpjyehcmn .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#scpjyehcmn .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#scpjyehcmn .gt_row_group_first td {
  border-top-width: 2px;
}

#scpjyehcmn .gt_row_group_first th {
  border-top-width: 2px;
}

#scpjyehcmn .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#scpjyehcmn .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#scpjyehcmn .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#scpjyehcmn .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#scpjyehcmn .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#scpjyehcmn .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#scpjyehcmn .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#scpjyehcmn .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#scpjyehcmn .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#scpjyehcmn .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#scpjyehcmn .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#scpjyehcmn .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#scpjyehcmn .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#scpjyehcmn .gt_left {
  text-align: left;
}

#scpjyehcmn .gt_center {
  text-align: center;
}

#scpjyehcmn .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#scpjyehcmn .gt_font_normal {
  font-weight: normal;
}

#scpjyehcmn .gt_font_bold {
  font-weight: bold;
}

#scpjyehcmn .gt_font_italic {
  font-style: italic;
}

#scpjyehcmn .gt_super {
  font-size: 65%;
}

#scpjyehcmn .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#scpjyehcmn .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#scpjyehcmn .gt_indent_1 {
  text-indent: 5px;
}

#scpjyehcmn .gt_indent_2 {
  text-indent: 10px;
}

#scpjyehcmn .gt_indent_3 {
  text-indent: 15px;
}

#scpjyehcmn .gt_indent_4 {
  text-indent: 20px;
}

#scpjyehcmn .gt_indent_5 {
  text-indent: 25px;
}

#scpjyehcmn .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#scpjyehcmn div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="table gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead><tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="label"><span class="gt_from_md"><strong>Characteristic</strong></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="estimate"><span class="gt_from_md"><strong>IRR</strong></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="conf.low"><span class="gt_from_md"><strong>95% CI</strong></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="p.value"><span class="gt_from_md"><strong>p-value</strong></span></th>
    </tr></thead>
<tbody class="gt_table_body">
<tr>
<td headers="label" class="gt_row gt_left">Household Income</td>
<td headers="estimate" class="gt_row gt_center"><br></td>
<td headers="conf.low" class="gt_row gt_center"><br></td>
<td headers="p.value" class="gt_row gt_center"><br></td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">    $50,001 to $60,000</td>
<td headers="estimate" class="gt_row gt_center">—</td>
<td headers="conf.low" class="gt_row gt_center">—</td>
<td headers="p.value" class="gt_row gt_center"><br></td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">    $0 to $10,000</td>
<td headers="estimate" class="gt_row gt_center">0.56</td>
<td headers="conf.low" class="gt_row gt_center">0.45, 0.70</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">    $10,001 to $20,000</td>
<td headers="estimate" class="gt_row gt_center">0.67</td>
<td headers="conf.low" class="gt_row gt_center">0.54, 0.82</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">    $20,001 to $30,000</td>
<td headers="estimate" class="gt_row gt_center">0.59</td>
<td headers="conf.low" class="gt_row gt_center">0.48, 0.71</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">    $30,001 to $40,000</td>
<td headers="estimate" class="gt_row gt_center">0.71</td>
<td headers="conf.low" class="gt_row gt_center">0.59, 0.85</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">    $40,001 to $50,000</td>
<td headers="estimate" class="gt_row gt_center">0.92</td>
<td headers="conf.low" class="gt_row gt_center">0.78, 1.09</td>
<td headers="p.value" class="gt_row gt_center">0.3</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">    $60,001 to $75,000</td>
<td headers="estimate" class="gt_row gt_center">1.09</td>
<td headers="conf.low" class="gt_row gt_center">0.93, 1.27</td>
<td headers="p.value" class="gt_row gt_center">0.3</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">    $75,001 to $100,000</td>
<td headers="estimate" class="gt_row gt_center">1.27</td>
<td headers="conf.low" class="gt_row gt_center">1.11, 1.46</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">    $100,001 to $150,000</td>
<td headers="estimate" class="gt_row gt_center">1.35</td>
<td headers="conf.low" class="gt_row gt_center">1.18, 1.55</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">    $150,001 to $200,000</td>
<td headers="estimate" class="gt_row gt_center">1.40</td>
<td headers="conf.low" class="gt_row gt_center">1.21, 1.62</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">    $200,001 to $250,000</td>
<td headers="estimate" class="gt_row gt_center">1.46</td>
<td headers="conf.low" class="gt_row gt_center">1.23, 1.73</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">    $250,001 or more</td>
<td headers="estimate" class="gt_row gt_center">1.67</td>
<td headers="conf.low" class="gt_row gt_center">1.44, 1.94</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td>
</tr>
</tbody>
<tfoot class="gt_sourcenotes"><tr>
<td class="gt_sourcenote" colspan="4"><span class="gt_from_md">Abbreviations: CI = Confidence Interval, IRR = Incidence Rate Ratio</span></td>
    </tr></tfoot>
</table>
</div>
<p>We observe that the $100-150k group has 1.35 (1.18, 1.55) times the
expected number of books compared to the $50-60k group.</p>
<p>We can also obtain the same comparison from the original reference
group (“$0 to $10,000”) by forming a contrast
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mi>β</mi></mrow><annotation encoding="application/x-tex">L \beta</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>L</mi><annotation encoding="application/x-tex">L</annotation></semantics></math>
selects the difference between the two relevant category
coefficients.</p>
<p>Alternatively, the same information can be derived by computing a
contrast using the original model:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">contrasts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"100-150k vs 50-60k"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># Get the difference in coefficients</span></span>
<span><span class="va">diff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">mdl_quasi</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">contrasts</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co"># And the standard error of the estimator</span></span>
<span><span class="va">se</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">contrasts</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">mdl_quasi</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">contrasts</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co"># Then we can do our inference:</span></span>
<span><span class="va">z</span> <span class="op">&lt;-</span> <span class="va">diff</span> <span class="op">/</span> <span class="va">se</span></span>
<span><span class="va">p_value</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">pnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">exp_diff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">diff</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Contrast <span class="op">=</span> <span class="st">"100-150k vs 50-60k"</span>,</span>
<span>  Estimate <span class="op">=</span> <span class="va">exp_diff</span>,</span>
<span>  CI <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"("</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">diff</span> <span class="op">-</span> <span class="fl">1.96</span> <span class="op">*</span> <span class="va">se</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">", "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">diff</span> <span class="op">+</span> <span class="fl">1.96</span> <span class="op">*</span> <span class="va">se</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">")"</span><span class="op">)</span>,</span>
<span>  z <span class="op">=</span> <span class="va">z</span>,</span>
<span>  p_value <span class="op">=</span> <span class="va">p_value</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;             Contrast Estimate           CI        z      p_value</span></span>
<span><span class="co">#&gt; 1 100-150k vs 50-60k 1.350932 (1.18, 1.54) 4.429499 9.445218e-06</span></span></code></pre></div>
<p>This RR and CI match what you get from the re-leveled model (down to
some rounding error), without changing the baseline each time.</p>
</div>
<div class="section level2">
<h2 id="takeaways">Takeaways<a class="anchor" aria-label="anchor" href="#takeaways"></a>
</h2>
<ul>
<li><p><strong>Poisson GLM Assumption:</strong> The Poisson GLM assumes
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Var</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>Y</mi><mo>∣</mo><mi>X</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>μ</mi></mrow><annotation encoding="application/x-tex">\text{Var}(Y \mid X) = \mu</annotation></semantics></math>.
If the mean and variance are correctly specified, squared Pearson
residuals should hover around 1.</p></li>
<li><p><strong>Overdispersion Impact:</strong> Ignoring overdispersion
inflates type I error rates. This can lead to overly narrow confidence
intervals and underestimated standard errors.</p></li>
<li>
<p><strong>Addressing Overdispersion:</strong></p>
<ul>
<li>Use <strong>quasi-Poisson</strong> or <strong>robust standard
errors</strong> to fix inference while keeping the same mean model.</li>
<li>Use <strong>negative binomial regression</strong> to adjust the
variance model parametrically.</li>
</ul>
</li>
<li><p><strong>Linear Contrasts:</strong> Linear contrasts allow direct
comparisons between any two income groups without re-leveling the
factor. This avoids the need to refit the model for each
comparison.</p></li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jessalyn Sebastian, Volodymyr Minin.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
